#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Navegamos al directorio raíz del proyecto
cd "$(dirname "$0")/.."

echo "Construyendo la aplicación..."
cd bolsafeucn_back

# Primero restauramos las dependencias silenciosamente
dotnet restore --verbosity quiet > /dev/null 2>&1

# Luego construimos el proyecto
dotnet build bolsafeucn_back.csproj --no-restore --verbosity quiet

BUILD_EXIT_CODE=$?

if [ $BUILD_EXIT_CODE -eq 0 ]; then
    echo "✓ Build exitoso - Pre-push completado"
    exit 0
else
    echo "✗ Build falló - El push ha sido bloqueado"
    echo "Por favor, corrija los errores de compilación antes de hacer push"
    exit 1
fi